if (self.CavalryLogger) { CavalryLogger.start_js(["RsGzu"]); }

__d("WebGraphQL",["ActorURI","AsyncRequest","Deferred","FBLogger","WebGraphQLConfig","XGraphQLBatchAPIController","getAsyncParams"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){__p&&__p();var c=a.getURIBuilder().getURI(),d={exec:function(a,b){return d.execAll([a],b)[0]},execAll:function(a,d){__p&&__p();var e={},f={};a=a.map(function(a,c){c="o"+c;e[c]={doc_id:a.__getDocID(),query_params:a.__getVariables()};a=new(b("Deferred"))();f[c]=a;return a.getPromise()});var g=babelHelpers["extends"]({},b("getAsyncParams")("POST"));d&&d.actorID!=null&&(g[b("ActorURI").PARAMETER_ACTOR]=d.actorID);var h=d&&d.batchName?{batch_name:d.batchName}:{};h=new(b("AsyncRequest"))().setURI(c).setOption("suppressEvaluation",!0).setMethod("POST").setRequestHeader("Content-Type","application/x-www-form-urlencoded").setData(babelHelpers["extends"]({},h,g,{queries:JSON.stringify(e)})).setHandler(function(a){__p&&__p();a=a.getPayload();try{var c=a.response.split("\r\n");c.pop();c=c.map(function(a){return JSON.parse(a)});c.forEach(function(a){return Object.keys(a).forEach(function(b){var c=f[b];if(c){b=a[b];b.errors?c.reject(b):b.data?c.resolve(b.data):c.reject({data:{},errors:[{message:"Unexpected response received from server.",severity:"CRITICAL",response:b}]})}})})}catch(d){c=a.response;b("FBLogger")("webgraphql").catching(d).mustfix("Bad response: ","%s%s",c.substr(0,250),c.length>250?"[truncated]":"")}Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"No response received from server.",severity:"CRITICAL"}]})})}).setTimeoutHandler(b("WebGraphQLConfig").timeout,function(){Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"Request timed out.",severity:"CRITICAL"}]})})}).setErrorHandler(function(a){var b=a.getErrorDescription();Object.keys(f).forEach(function(c){f[c].isSettled()||f[c].reject({data:{},errors:[{message:b,severity:"CRITICAL",error:a.getError()}]})})});d&&d.msgrRegion&&h.setRequestHeader("X-MSGR-Region",d.msgrRegion);h.setAllowCrossPageTransition(!0);h.send();return a},__forController:g};return d}a=g(b("XGraphQLBatchAPIController"));e.exports=a}),null);
__d("BaseGraphQLSubscription",["regeneratorRuntime","BladeRunnerWWWRolloutUtils","CurrentLocale","CurrentUser","GQLSHeartbeatConfig","Random","RelayRTIUtils","SkywalkerManager","gkx","nullthrows","relay-runtime","uuid"],(function(a,b,c,d,e,f){__p&&__p();var g=b("GQLSHeartbeatConfig").heartbeat_interval,h=b("RelayRTIUtils").computeRoutingHint,i=b("RelayRTIUtils").logClientEvent,j=b("relay-runtime").getRequest,k=100,l="gqls_default_logging";function m(a){if(b("gkx")("676906")&&b("Random").coinflip(k))return l;a=b("BladeRunnerWWWRolloutUtils").getRolloutPositionForSubscription(a);if(a==b("BladeRunnerWWWRolloutUtils").inRolloutWhitelist&&b("Random").coinflip(b("BladeRunnerWWWRolloutUtils").BRSamplingRate))return b("BladeRunnerWWWRolloutUtils").wwwBRRolloutWebGraphqlBRForceLogContext}a=function(){"use strict";__p&&__p();function a(){}var c=a.prototype;c.getTopic=function(a){throw new Error("getTopic() unimplemented by subclass of BaseGraphQLSubscription")};c.getQuery=function(){throw new Error("getQuery() or getQueryID() unimplemented by subclass of BaseGraphQLSubscription")};c.getQueryParameters=function(a){throw new Error("getQueryParameters() unimplemented by subclass of BaseGraphQLSubscription")};c.getSubscriptionName=function(){var a=j(this.getQuery());return String(b("nullthrows")(a.params.metadata.subscriptionName))};a.subscribe=function(a,b,c){c===void 0&&(c={});return new this().subscribe(a,b,c)};c.subscribe=function(a,c,d){__p&&__p();var e;d===void 0&&(d={});var f=this.getTopic(a),k=b("SkywalkerManager").getSubscriptionType(f),l=this.getQueryParameters(a);a=b("uuid")();l=babelHelpers["extends"]({},l,{input:babelHelpers["extends"]({},l.input,{client_subscription_id:a})});var n=(e=d.forceLogContext)!=null?e:m(f);n!=null&&(l=babelHelpers["extends"]({},l,{"%options":{client_logged_context:n}}));d.receiveLifecycleEvents&&(l=babelHelpers["extends"]({},l,{"%options":babelHelpers["extends"]({},l["%options"],{heartbeat:{interval:g}})}));e={};a=b("gkx")("1243442")||n?{"request-id":a}:null;e.transformContext=JSON.stringify(this.getTransformContext(l,d.viewerID));d.policy!=null&&(e.policy=d.policy);d.customOptions!=null&&(e.customOptions=JSON.stringify(d.customOptions));d=h(this.getSubscriptionName(),l.input);if(d!=null){var o;a=babelHelpers["extends"]({},(o=a)!=null?o:{},{routing_hint:d})}var p=this.getSubscriptionName(),q=b("nullthrows")(j(this.getQuery()).params.id);i("client_subscribe",p,l,n,k,q);var r=b("SkywalkerManager").subscribe(f,function(a){i("receivepayload",p,l,n,k,q),c(babelHelpers["extends"]({__type:"data"},JSON.parse(a.payload)))},babelHelpers["extends"]({context:e,onUnsubscribeEager:function(){i("client_unsubscribe",p,l,n,k,q)},gqlsLifecycleHandler:function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:c({__type:"lifecycle_event",state:a});case 1:case"end":return b.stop()}},null,this)}},a?{headers:a}:{}));return{getContext:function(){return r.getContext()},unsubscribe:function(){r.unsubscribe()}}};c.getTransformContext=function(a,c){var d=0;return{viewerID:(c=c)!=null?c:b("CurrentUser").getID(),appID:d,locale:b("CurrentLocale").get(),queryID:b("nullthrows")(j(this.getQuery()).params.id),serializedQueryParameters:JSON.stringify(a)}};return a}();e.exports=a}),null);